<x-app-layout>
    <x-slot name="header">
        <div class="flex justify-between items-center">
            <div>
                <h2 class="text-xl font-semibold">Compte <span class="text-indigo-700">{{ $account->name }}</span></h2>
                <div class="text-sm text-gray-400">
                    Portfolio
                    <a href="{{ route('portfolio.show', $account->portfolio) }}" class="text-indigo-400 underline hover:no-underline">{{ $account->portfolio->name }}</a>
                </div>
            </div>
            <div class="text-sm flex text-indigo-300 hover:text-indigo-700 transition-colors ease-linear delay-100">
                <a href="{{ route('account.edit', [/* 'portfolio' => $portfolio, */ 'account' => $account]) }}" class="px-2 underline hover:no-underline">Modifier</a>
            </div>
        </div>
    </x-slot>

    @if (session('message'))
        <x-alert type="info" class="max-w-6xl mx-auto mb-6">
            {{ session('message') }}
        </x-alert>
    @endif

    @if (session()->has('alert'))
        <x-alert type="success" class="max-w-6xl mx-auto mb-6">
            {{ session('alert') }}
        </x-alert>
    @endif

    <div class="max-w-6xl mx-auto mb-6">
        <x-primary-button
            class="block"
            style="display: block; margin-left: auto"
            x-data=""
            x-on:click.prevent="$dispatch('open-modal', 'operation.create')"
        >Écrire une opération</x-primary-button>
    </div>

    <div class="max-w-6xl mx-auto rounded-lg shadow mt-6 mb-6 overflow-hidden">
        <table class="w-full">
            <thead class="bg-gray-100 text-xs font-semibold uppercase tracking-wide">
                <tr>
                    <th class="border px-3 py-2">ID</th>
                    <th class="border px-3 py-2">Date opération</th>
                    <th class="border px-3 py-2">Description</th>
                    <th class="border px-3 py-2">Montant</th>
                    <th class="border px-3 py-2">Cumul</th>
                    <th class="border px-3 py-2">Horodatage création</th>
                    <th class="border px-3 py-2">Action</th>
                </tr>
            </thead>
            <tbody class="bg-white">
                @foreach ($account->operations as $operation)
                    <tr class="hover:bg-yellow-100">
                        <td class="border px-3 py-2 text-right">{{ $operation->id }}</td>
                        <td class="border px-3 py-2 text-center">{{ date('d/m/Y', strtotime($operation->delivery_at)) }}</td>
                        <td class="border px-3 py-2">{{ $operation->description }}</td>
                        <td class="border px-3 py-2 text-right">{{ Number::currency($operation->amount, in: 'EUR', locale: 'fr') }}</td>
                        <td class="border px-3 py-2 text-right">--</td>
                        <td class="border px-3 py-2 text-center">{{ $operation->created_at?->format('d/m/Y H:i:s') }}</td>
                        <td class="border px-3 py-2 text-center">
                            <a href="#" class="text-xs font-semibold uppercase text-indigo-700 underline hover:no-underline">Modifier</a>
                        </td>
                    </tr>
                @endforeach
            </tbody>
        </table>
    </div>

    <x-modal name="operation.create" :show="$errors->operationCreate->isNotEmpty()" focusables>

        @include('operation.partials.form', [
            'action' => route('operation.store', [
                'portfolio' => $account->portfolio,
                'account' => $account,
            ]),
            'operation' => null,
            'method' => 'post',
            'button' => 'Enregistrer',
            'abort' => route('account.show', [
                // 'portfolio' => $portfolio,
                'portfolio' => $account->portfolio,
                'account' => $account,
            ]),
        ])

    </x-modal>

    <x-modal name="operation.edit" :show="$errors->operationUpdate->isNotEmpty()" focusables>
    </x-modal>

</x-app-layout>
